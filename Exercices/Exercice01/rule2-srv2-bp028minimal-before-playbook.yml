---
###############################################################################
#
# Ansible Playbook generated from evaluation of ANSSI-BP-028 (minimal)
#
# Profile ID: xccdf_org.ssgproject.content_profile_anssi_nt28_minimal
# XCCDF Version:  unknown
#
# Evaluation Start Time:  2021-12-04T18:26:52
# Evaluation End Time:  2021-12-04T18:26:53
#
# This file was generated by OpenSCAP 1.3.3 using:
# $ oscap xccdf generate fix --result-id xccdf_org.open-scap_testresult_xccdf_org.ssgproject.content_profile_anssi_nt28_minimal --fix-type ansible xccdf-results.xml
#
# This Ansible Playbook is generated from the results of a profile evaluation.
# It attempts to remediate all issues from the selected rules that failed the test.
#
# How to apply this Ansible Playbook:
# $ ansible-playbook -i "localhost," -c local playbook.yml
# $ ansible-playbook -i "192.168.1.155," playbook.yml
# $ ansible-playbook -i inventory.ini playbook.yml
#
###############################################################################


- hosts: all
  vars:
    var_accounts_password_minlen_login_defs: !!str 18
  tasks:
    - name: Gather the package facts
      package_facts:
        manager: auto
      tags:
        - CCE-82049-8
        - CJIS-5.6.2.1
        - NIST-800-171-3.5.7
        - NIST-800-53-CM-6(a)
        - NIST-800-53-IA-5(1)(a)
        - NIST-800-53-IA-5(f)
        - accounts_password_minlen_login_defs
        - low_complexity
        - low_disruption
        - medium_severity
        - no_reboot_needed
        - restrict_strategy



    - name: Set Password Minimum Length in login.defs
      lineinfile:
        dest: /etc/login.defs
        regexp: ^PASS_MIN_LEN *[0-9]*
        state: present
        line: PASS_MIN_LEN        {{ var_accounts_password_minlen_login_defs }}
        create: true
      when: '"shadow-utils" in ansible_facts.packages'
      tags:
        - CCE-82049-8
        - CJIS-5.6.2.1
        - NIST-800-171-3.5.7
        - NIST-800-53-CM-6(a)
        - NIST-800-53-IA-5(1)(a)
        - NIST-800-53-IA-5(f)
        - accounts_password_minlen_login_defs
        - low_complexity
        - low_disruption
        - medium_severity
        - no_reboot_needed
        - restrict_strategy


